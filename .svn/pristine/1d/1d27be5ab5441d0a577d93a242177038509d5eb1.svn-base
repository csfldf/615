/**
 * Created by jiadongy on 9/30/2014.
 */
/**
 * Deps Config
 */
avalon.config({
    paths:{
        utils:'main/utils',
        RouterManager:'main/RouterManager',
        UIMainFrame:'main/UIMainFrame',
        perInfo:'main/perInfoMgr',
        Login:'main/Login',
        permissionMgr:'main/permissionMgr',
        selector:'main/selector/selector',
        usrOpt:'main/userOption/usrOpt',
        homePage:'main/homePage',
        authorityMgr:'main/authorityMgr',
        //Business Library
        'employeeManager':'main/employeeManager',
        'am.amConfig':'module/am/amConfig',
        'am.amCommonFunc':'module/am/amCommonFunc',
        //my settings
        //*========================plan part=========================*//
        'am.testFilter':'module/am/testFilter',
        'am.planViewMgr':'module/am/planViewMgr',
        'am.taskViewMgr':'module/am/taskViewMgr',
        'am.packageViewMgr':'module/am/packageViewMgr',
        'am.actionDecompose':'module/am/actionDecompose',
        'am.actionViewMgr':'module/am/actionViewMgr',
        'am.actionDirViewMgr': 'module/am/actionDirViewMgr',
        'am.actionSummary':'module/am/actionSummary',
        'am.msgDetail':'module/am/msgDetailMgr',
        'am.taskDecompose':'module/am/taskDecompose',
        'am.docLibrary':'module/am/docLibrary',
        'am.prjDef':'module/am/prjDef',
        'am.prjCreate':'module/am/prjCreate',
        'am.prjMaintain':'module/am/prjMaintain',
        'am.planStatisticsMgr':'module/am/planStatisticsMgr',
        'am.empMgr':'module/am/empMgr',
        'am.depMgr':'module/am/departmentMgr',
        'am.privilegeMgr':'module/am/privilegeMgr',
        'am.metadataSummary':'module/am/metadataMgr',
        'am.commMgr':'module/am/communicationMgr',
        'am.planTree':'module/am/amProjectTree',
        'am.sessionUtil':'module/am/amSessionUtil',
        'am.searchUtil':'module/am/amSearchUtil',
        'am.planSummary':'module/am/planSummary',
        'am.planListMgr':'module/am/planListMgr',
        'am.cookie':'avalon/cookie/avalon.cookie',
        'am.zyCookie':'module/am/zyCookie',
        'am.planList2ReportMgr':'module/am/planList2ReportMgr',
        'am.tree':"../simpletree/simpletree.js",
        'am.planReportMgr':'module/am/planReportMgr',
        'am.projectManager':'module/am/projectManager',
        'am.projectMgr_new':'module/am/projectMgr_new',
        'am.amProjectTree':'module/am/amProjectTree',
        'am.projectTree':'module/am/projectTree',
        'am.groupManager':'module/am/groupManager',
        'am.groupMemberManager':'module/am/groupMemberManager',
        'fracas.fracasConfig' : 'module/fracas/fracasConfig',
        'fracas.projectSelect' : 'module/fracas/projectSelect',
        'fracas.sessionUtil' : 'module/fracas/sessionUtil',
        'fracas.fracasDataPicker' : 'module/fracas/fracasDataPicker',
        'fracas.eventSummary' : 'module/fracas/eventSummary',
        'fracas.failureReport' : 'module/fracas/failureReport',
        'fracas.car' : 'module/fracas/car',
        'fracas.drafts' : 'module/fracas/drafts',
        'fracas.failureAnalyse' : 'module/fracas/failureAnalyse',
        'fracas.failureHandle' : 'module/fracas/failureHandle',
        'fracas.reportSearch' : 'module/fracas/reportSearch',
        'fracas.reportData' : 'module/fracas/reportData',
        'fracas.metadataManagement' : 'module/fracas/metadataManagement',
        'fracas.projectManagement' : 'module/fracas/projectManagement',
        'fracas.searchUtil' : 'module/fracas/searchUtil',
        'cm.cmConfig' : 'module/cm/cmConfig',
        'cm.contractRegist' : 'module/cm/contractRegist',
        'cm.payNode' : 'module/cm/payNode',
        'cm.receiveNode' : 'module/cm/receiveNode',
        //Third Party Library
        'bootSideMenu': 'base/BootSideMenu',
        'simpleFSM':'simpleFSM/simpleFSM',
        'validation':'base/jqBootstrapValidation',
        'echarts':'base/echarts/echarts-all',
        'chart': 'base/chart/Chart.js',
        jquery:'base/jquery-1.11.1',
        bootstrap:'base/bootstrap',
        datatables:'base/dataTables',
        'datatables.bootstrap':'base/dataTables.bootstrap2',
        'datatables.tabletools':'base/dataTables.tableTools',
        //'datatables.buttons.bootstrap':'base/dataTables.buttons/js/dataTables.buttons',
        tabdrop:'base/bootstrap-tabdrop',
        fineuploader:'base/all.fineuploader-5.0.7.min',
        contextmenu:'base/jquery.contextmenu',
        datepicker:'base/bootstrap-datepicker/bootstrap-datepicker',
        datepicker_zh_CN: 'base/bootstrap-datepicker/locales/bootstrap-datepicker.zh-CN',
        slideout: 'base/slideout',
    },
    shim:{
        bootSideMenu:{
            deps:['jquery','css!../css/BootSideMenu.css']
        },
        bootstrap:{
            deps:['jquery','css!../css/base/bootstrap.css']
        },
        'datetables':{
            deps:['jquery','css!../css/base/dataTables.css']
        },
        'datatables.bootstrap':{
            deps:['jquery','datatables','css!../css/base/dataTables.css','css!../css/base/dataTables.bootstrap2.css']
        },
        'datatables.tabletools':{
            deps: ['jquery', 'datatables.bootstrap', 'css!../css/base/dataTables.tableTools.css']
        },
        /*'datatables.buttons.bootstrap':{
         deps:['jquery','datatables.bootstrap',
         'base/dataTables.buttons/js/dataTables.buttons',
         'base/dataTables.buttons/js/buttons.bootstrap',
         'base/dataTables.buttons/js/buttons.flash',
         //'base/dataTables.buttons/js/buttons.print',
         //'base/dataTables.buttons/js/buttons.html5',
         'css!../css/base/dataTables.buttons/buttons.bootstrap.css',
         'css!../css/base/dataTables.buttons/buttons.dataTables.css']
         },*/
        tabdrop:{
            deps:['jquery','css!../css/base/bootstrap-tabdrop.css']
        },
        fineuploader:{
            deps:['jquery','css!../css/base/fineuploader-5.0.7.min.css']
        },
        contextmenu:{
            deps:['jquery']
        },
        validation:{
            deps:['jquery']
        },
        'select2':{
            deps:['jquery','base/select2','css!../css/base/select2.css','css!../css/base/select2-bootstrap.css']
        },
        datepicker:{
            deps:['jquery','css!../css/base/datepicker.css']
        },
        'datepicker_zh_CN':{
            deps:['datepicker']
        }

    }
});
/**
 * UIMainFrame Config
 */
require(['UIMainFrame','RouterManager','am.amConfig', 'fracas.fracasConfig', 'cm.cmConfig','Login'],
    function(main,rm,$am, $fracas, $cm, loginVM){
    /**
     * 导航栏全局设置
     * @type {{leftMenu: {text: string, href: string}[], rightMenu: {text: string, href: string, submenu: {text: string, href: string, submenu: {text: string, href: string}[]}[]}[]}}
     */
    loginVM.checkLogin();
    var navbarConfig={
        leftMenu: [{text: '首页', href: '#!/homePage', badge: 0}, {text: '项目概览', href: '#!/am/prj_def'},],
        dropdownMenu: [ {text: '项目定义',
            href:'#',
            submenu:[{text:'创建项目',href:'#!/am/prj_def/createPrj'},{text:'项目团队维护',href:'#!/am/prj_def/grpMaintain'},]
        },],
        //rightMenu:[{text:'Mails',href:'#',submenu:[{text:'View All Mails',href:'#',submenu:[{text:'Mail1991',href:'#'}]}]},{text:'登陆',href:"#",submenu:[{text:'LogOut',href:'#',submenu:[{text:'Exit',href:'#'}]}]}],
        //amMenu:[{text:'行动项管理',href:'#!/am',badge:12}],
        rightMenu: [
            {text: '计划管理', href: '#!/am', badge: 0}, {
                text: '行动项管理',
                href: '#!/action',
                badge: 0
            }, /*{text:'Fracas管理',href:'#!/fracas',badge:15},*/{text: '沟通管理', href: '#!/am/comm_mgm'}, {
                text: '模板库',
                href: '#!/docLibrary'
            },
        ],
        dropdownMenu2: [{text:'基础数据维护',href:'#',submenu:[{text:'人员库管理',href:'#!/am/employeeMgr'},{text:'部门库管理',href:'#!/am/depMgr'},
//            {text:'权限管理',href:'#!/am/privilegeMgr'}
        ]
        }]
    }

    //main.addSidebar('fastAccessBar',fastAccessConfig,true);
    main.setNavMenu(navbarConfig);
    /**
     * 左侧侧边栏全局设置
     * @type {{header: string, submenu: {text: string, href: string}[]}[]}
     */
    /*var mainSidebarConfig=[{header:'DashBoard',submenu:[{text:'DashBoard',href:'#'}]}];
    main.addSidebar('mainSidebar',mainSidebarConfig,true);
    main.switchSidebar('mainSidebar');*/
    //main.addSidebar('amSidebar',$am.amSidebarConfig)//Import AM Sidebar Config
    /**
     * 右侧选项卡全局设置
     * @type {{tabName: string, tabContent: string, useHref: boolean, href: string}}
     */
    /*var mainTabConfig={tabName: 'DashBoard',tabContent: "It's a DashBoard Page",removable:false};
    main.addTab(mainTabConfig);*/
    //main.applyNavMenu();
    //main.applySidebar();
    //main.applyTab();
    main.applyAll(document.body);

    /**
     * Router Rules Config
     */
    var mainRules=[
        //Rule Part of MainFrame
        {path:'/',process:function(a){
            main.switchSidebar('mainSidebar');}
        },
        {path:'/random{id}',process:function(a){
            a;
        }}
    ];
    rm.addRules(mainRules);
    $am.init();
    $cm.init();
    //rm.addRules($am.amInitRules);
    rm.addRules($fracas.fracasInitRules);
    rm.avalon.history.start();
})

